{"openapi": "3.1.0", "info": {"title": "StoryTangl", "description": "RESTful endpoints for a narrative engine for creating interactive stories", "version": "2.8.2"}, "paths": {"/story/update": {"get": {"tags": ["Story"], "summary": "Get Story Update", "description": "Retrieve the current story update for this user.\n\nThis endpoint provides the current status of the story, including the\nblock of text currently being displayed, any actions available to the\nuser, and any media associated with the current state of the story.", "operationId": "get_story_update_story_update_get", "parameters": [{"name": "user-id", "in": "header", "required": false, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/JournalStoryUpdate"}, "title": "Response Get Story Update Story Update Get"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/do": {"post": {"tags": ["Story"], "summary": "Do Story Action", "operationId": "do_story_action_story_do_post", "parameters": [{"name": "user-id", "in": "header", "required": false, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"$ref": "#/components/schemas/ActionRequest"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/JournalStoryUpdate"}, "title": "Response Do Story Action Story Do Post"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/status": {"get": {"tags": ["Story"], "summary": "Get Story Status", "operationId": "get_story_status_story_status_get", "parameters": [{"name": "user-id", "in": "header", "required": false, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/KVItem"}, "title": "Response Get Story Status Story Status Get"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/drop": {"delete": {"tags": ["Story"], "summary": "Reset Story", "operationId": "reset_story_story_drop_delete", "parameters": [{"name": "user-id", "in": "header", "required": false, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/JournalStoryUpdate"}, "title": "Response Reset Story Story Drop Delete"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/go": {"put": {"tags": ["Story", "Restricted"], "summary": "Goto Story Block", "description": "Navigate directly to a specific block in the story (restricted)\n\nThis endpoint updates the current story bookmark to the specified block.\nForcing a block open will mark the story as 'dirty'.", "operationId": "goto_story_block_story_go_put", "parameters": [{"name": "block_id", "in": "query", "required": true, "schema": {"type": "string", "format": "uuid", "title": "Block Id"}, "example": "scene_1/block_1"}, {"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/JournalStoryUpdate"}, "title": "Response Goto Story Block Story Go Put"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/info": {"get": {"tags": ["Story", "Restricted"], "summary": "Inspect Story Node", "description": "Retrieve information about a specific node in the story (restricted)\n\nThis endpoint provides information about the specified node.", "operationId": "inspect_story_node_story_info_get", "parameters": [{"name": "node_id", "in": "query", "required": true, "schema": {"type": "string", "format": "uuid", "title": "Node Id"}, "example": "scene_1/block_1"}, {"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/BaseResponse"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/check": {"post": {"tags": ["Story", "Restricted"], "summary": "Check Expression", "description": "Dynamically evaluate a expression in the current story (restricted)", "operationId": "check_expression_story_check_post", "parameters": [{"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "string", "title": "Expr"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "object", "title": "Response Check Expression Story Check Post"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/story/apply": {"post": {"tags": ["Story", "Restricted"], "summary": "Apply Effect", "description": "Apply an effect expression in the current story (restricted)\n\nDirectly manipulating the game state will mark the story as 'dirty'.", "operationId": "apply_effect_story_apply_post", "parameters": [{"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "string", "title": "Expr"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "object", "title": "Response Apply Effect Story Apply Post"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/user/info": {"get": {"tags": ["User"], "summary": "Get User Info", "description": "Retrieve information about the specified user.\n\nIn particular, this endpoint provides the current world_id for\nthe user's story bookmark.", "operationId": "get_user_info_user_info_get", "parameters": [{"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/UserInfo"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/user/create": {"post": {"tags": ["User"], "summary": "Create User", "description": "Create a new user and return the user_id and secret.\n\nThis endpoint creates a new user in the system.  This is a public endpoint.", "operationId": "create_user_user_create_post", "parameters": [{"name": "secret", "in": "query", "required": false, "schema": {"type": "string", "title": "Secret"}, "example": "pr3tty h0p3"}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/UserSecret"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/user/world": {"put": {"tags": ["User"], "summary": "Set User World", "operationId": "set_user_world_user_world_put", "parameters": [{"name": "user-id", "in": "header", "required": false, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "requestBody": {"required": true, "content": {"application/json": {"schema": {"type": "string", "format": "uuid", "title": "World Id"}}}}, "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {"$ref": "#/components/schemas/JournalStoryUpdate"}, "title": "Response Set User World User World Put"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/user/secret": {"put": {"tags": ["User"], "summary": "Update User Secret", "description": "- Update secret for an existing user and return the new api key\n- If no secret is provided, a random secret is generated and returned with the new api key\n- Sets an auth cookie for dynamic assets.\n- Client must call 'story/update' with new key for update frame", "operationId": "update_user_secret_user_secret_put", "parameters": [{"name": "secret", "in": "query", "required": false, "schema": {"type": "string", "title": "Secret"}, "example": "pr3tty h0p3"}, {"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/UserSecret"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/user/drop": {"delete": {"tags": ["User"], "summary": "Drop User", "description": "Delete the current user.\n\nTypically, the client will follow up by creating a new user and\nregistering a new api key", "operationId": "drop_user_user_drop_delete", "parameters": [{"name": "user-id", "in": "header", "required": true, "schema": {"type": "string", "format": "uuid", "title": "User-Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/world/{world_id}/info": {"get": {"tags": ["World"], "summary": "Get World Info", "description": "Retrieve info about the specified world.\n\nThis endpoint provides a mapping of world-specific metadata like description, title,\nauthors, banner media, etc.", "operationId": "get_world_info_world__world_id__info_get", "parameters": [{"name": "world_id", "in": "path", "required": true, "schema": {"type": "string", "title": "World Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/WorldInfo"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/world/{world_id}/scenes": {"get": {"tags": ["World", "Restricted"], "summary": "Get Scene List", "description": "List scenes in a world (restricted)", "operationId": "get_scene_list_world__world_id__scenes_get", "parameters": [{"name": "world_id", "in": "path", "required": true, "schema": {"type": "string", "format": "uuid", "title": "World Id"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"type": "array", "items": {}, "title": "Response Get Scene List World  World Id  Scenes Get"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/system/info": {"get": {"tags": ["System"], "summary": "Get System Info", "description": "Retrieve the current status of the system.\n\nThis endpoint provides information about the system status, including the\nuptime, a media url for info, and the url for the guide, if applicable.", "operationId": "get_system_info_system_info_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/SystemInfo"}}}}}}}, "/system/worlds": {"get": {"tags": ["System"], "summary": "Get Worlds", "description": "Retrieve a list of the available worlds.\n\nThis is a public endpoint that gives the ids for all the playable worlds that this server knows about.", "operationId": "get_worlds_system_worlds_get", "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"items": {"$ref": "#/components/schemas/WorldListItem"}, "type": "array", "title": "Response Get Worlds System Worlds Get"}}}}}}}, "/system/secret": {"get": {"tags": ["System"], "summary": "Get Key For Secret", "description": "Retrieve a user key based on a secret.\n\nThis is a public endpoint that enables users to restore credentials.", "operationId": "get_key_for_secret_system_secret_get", "parameters": [{"name": "secret", "in": "query", "required": false, "schema": {"type": "string", "title": "Secret"}, "example": "pr3tty h0p3"}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/UserSecret_"}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}, "/system/reset": {"put": {"tags": ["System", "Restricted"], "summary": "Reset System", "description": "Reset the system (restricted)\n\nThis endpoint drops all worlds and reloads them. If the 'hard' parameter is set\nto True, it also discards all users and story data.", "operationId": "reset_system_system_reset_put", "parameters": [{"name": "hard", "in": "query", "required": false, "schema": {"default": false, "title": "Hard"}}], "responses": {"200": {"description": "Successful Response", "content": {"application/json": {"schema": {}}}}, "422": {"description": "Validation Error", "content": {"application/json": {"schema": {"$ref": "#/components/schemas/HTTPValidationError"}}}}}}}}, "components": {"schemas": {"ActionRequest": {"properties": {"action_id": {"type": "string", "format": "uuid", "title": "Action Id"}, "payload": {"type": "object", "title": "Payload"}}, "type": "object", "required": ["action_id"], "title": "ActionRequest"}, "BaseJournalItem": {"properties": {"uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "text": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Text"}, "icon": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Icon"}}, "additionalProperties": true, "type": "object", "required": ["uid"], "title": "BaseJournalItem", "description": "Represents a basic content element in the journal and the core\nschema for communicating story-content to the front-end.\n\nAttributes:\n  - uid (UUID): Unique identifier of the generating story entity.\n  - text (str): Rendered content text.\n  - icon (str): Suggested icon."}, "BaseResponse": {"properties": {}, "additionalProperties": true, "type": "object", "title": "BaseResponse"}, "Entity": {"properties": {"uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "tags": {"items": {"type": "string"}, "type": "array", "title": "Tags"}}, "type": "object", "title": "Entity", "description": "Base class for all Managed Objects. Serves as the foundational class for all objects within the framework, leveraging Pydantic for data validation and serialization.\n\nUses \"SelfCastingMetaclass\", which consumes an \"obj_cls\" parameter on `__new__` and attempts to dynamically cast itself to the correct subclass.\n\nAttributes:\n  - `uid`: Provides a unique identifier for instances, crucial for tracking objects within the graph and serialization processes.\n  - `label`: Acts as a public name or a truncated `uid` if a name isn't specified, supporting both unique and context-specific identification needs.\n  - `tags`: A flexible mechanism to classify and filter entities based on characteristics or roles.\n\nMethods:\n  - `has_tags`: Facilitates querying based on tags, enhancing searchability and categorization.\n  - `model_dump`: Custom serialization logic that ensures compatibility with stateless service requirements by focusing on essential attributes.\n  - `get_all_subclasses` & `get_subclass_by_name`: Enable dynamic type discovery and instantiation, supporting extensibility and modular design."}, "Enum": {"enum": [], "title": "Enum", "description": "Create a collection of name/value pairs.\n\nExample enumeration:\n\n>>> class Color(Enum):\n...     RED = 1\n...     BLUE = 2\n...     GREEN = 3\n\nAccess them by:\n\n- attribute access::\n\n>>> Color.RED\n<Color.RED: 1>\n\n- value lookup:\n\n>>> Color(1)\n<Color.RED: 1>\n\n- name lookup:\n\n>>> Color['RED']\n<Color.RED: 1>\n\nEnumerations can be iterated over, and know how many members they have:\n\n>>> len(Color)\n3\n\n>>> list(Color)\n[<Color.RED: 1>, <Color.BLUE: 2>, <Color.GREEN: 3>]\n\nMethods can be added to enumerations, and members can have their own\nattributes -- see the documentation for details."}, "Graph": {"properties": {"uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "tags": {"items": {"type": "string"}, "type": "array", "title": "Tags"}, "nodes": {"additionalProperties": {"$ref": "#/components/schemas/Node"}, "type": "object", "title": "Nodes"}, "factory": {"allOf": [{"$ref": "#/components/schemas/Entity"}]}}, "type": "object", "title": "Graph", "description": "Acts as the central repository for all nodes within a story, mapping unique identifiers to node instances.\n\nAttributes:\n  - `nodes`: A dictionary that maps UUIDs to Nodes, forming the backbone of the narrative structure.\n\nMethods:\n  - `add_node`: Incorporates nodes into the graph, underpinning the dynamic expansion of the narrative.\n  - `_nodes_by_path`: A cached property that facilitates lookup by nested labels, enhancing the ability to trace narrative threads and relationships.\n  - `get_node`, `find_nodes`, `find_node`: Provide robust search and retrieval functionalities, crucial for navigating and manipulating the narrative structure."}, "HTTPValidationError": {"properties": {"detail": {"items": {"$ref": "#/components/schemas/ValidationError"}, "type": "array", "title": "Detail"}}, "type": "object", "title": "HTTPValidationError"}, "JournalMediaItem": {"properties": {"uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "text": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Text"}, "icon": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Icon"}, "media_role": {"$ref": "#/components/schemas/MediaRole"}, "url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "Url"}, "data": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Data"}}, "additionalProperties": true, "type": "object", "required": ["uid", "media_role"], "title": "JournalMediaItem", "description": "This is the final data type that is produced by the service layer from a media resource generated by the domain layer.\n\nAttributes:\n  - uid (UUID): Unique identifier of the generating story entity.\n  - media_role (MediaRole): Intended use, e.g., `narrative_im`\n  - url (url): Path to resource for client.\n  - data (str): xml or base64 encoded data.\n  - text (str): Rendered content text.\n  - rit (RIT): Resource inventory tag to be processed into data or url by the service layer\n\nOnly one of url or data may be provided."}, "JournalStoryUpdate": {"properties": {"style_id": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Style Id"}, "style_cls": {"anyOf": [{"type": "string"}, {"items": {"type": "string"}, "type": "array"}], "title": "Style Cls"}, "style_dict": {"anyOf": [{"additionalProperties": {"type": "string"}, "type": "object"}, {"type": "null"}], "title": "Style Dict"}, "uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "text": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Text"}, "icon": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Icon"}, "media": {"anyOf": [{"items": {"anyOf": [{"$ref": "#/components/schemas/MediaNode"}, {"$ref": "#/components/schemas/JournalMediaItem"}]}, "type": "array"}, {"type": "null"}], "title": "Media"}, "actions": {"anyOf": [{"items": {"$ref": "#/components/schemas/BaseJournalItem"}, "type": "array"}, {"type": "null"}], "title": "Actions"}, "dialog": {"anyOf": [{"items": {"$ref": "#/components/schemas/StyledJournalItem"}, "type": "array"}, {"type": "null"}], "title": "Dialog"}}, "additionalProperties": true, "type": "object", "required": ["uid"], "title": "JournalStoryUpdate", "description": "Extends the basic StyledJournalItem model to represent a block of content\nin the journal, including media and choice and dialog micro-blocks.\n\nAttributes:\n  - uid (UUID): Unique identifier of the generating story entity.\n  - text (str): Main content text.\n  - icon (str): Suggested icon.\n\n  - media (list[MediaItem]): List of associated media items.\n  - actions (list[JournalItem]): User choices in this update.\n  - dialog (list[JournalItem]): Dialog items in this update.\n\n  - style_dict (dict[str, str]): Suggested HTML style attributes.\n  - style_classes (list[str]): Suggested HTML .classes for styling.\n  - style_id (str): Suggested HTML #id."}, "KVItem": {"properties": {"style_id": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Style Id"}, "style_cls": {"anyOf": [{"type": "string"}, {"items": {"type": "string"}, "type": "array"}], "title": "Style Cls"}, "style_dict": {"anyOf": [{"additionalProperties": {"type": "string"}, "type": "object"}, {"type": "null"}], "title": "Style Dict"}, "key": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Key"}, "value": {"anyOf": [{"type": "string"}, {"type": "integer"}, {"type": "number"}, {"enum": [], "title": "Enum", "description": "Create a collection of name/value pairs.\n\nExample enumeration:\n\n>>> class Color(Enum):\n...     RED = 1\n...     BLUE = 2\n...     GREEN = 3\n\nAccess them by:\n\n- attribute access::\n\n>>> Color.RED\n<Color.RED: 1>\n\n- value lookup:\n\n>>> Color(1)\n<Color.RED: 1>\n\n- name lookup:\n\n>>> Color['RED']\n<Color.RED: 1>\n\nEnumerations can be iterated over, and know how many members they have:\n\n>>> len(Color)\n3\n\n>>> list(Color)\n[<Color.RED: 1>, <Color.BLUE: 2>, <Color.GREEN: 3>]\n\nMethods can be added to enumerations, and members can have their own\nattributes -- see the documentation for details."}, {"type": "boolean"}, {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}, {"type": "number"}, {"enum": [], "title": "Enum", "description": "Create a collection of name/value pairs.\n\nExample enumeration:\n\n>>> class Color(Enum):\n...     RED = 1\n...     BLUE = 2\n...     GREEN = 3\n\nAccess them by:\n\n- attribute access::\n\n>>> Color.RED\n<Color.RED: 1>\n\n- value lookup:\n\n>>> Color(1)\n<Color.RED: 1>\n\n- name lookup:\n\n>>> Color['RED']\n<Color.RED: 1>\n\nEnumerations can be iterated over, and know how many members they have:\n\n>>> len(Color)\n3\n\n>>> list(Color)\n[<Color.RED: 1>, <Color.BLUE: 2>, <Color.GREEN: 3>]\n\nMethods can be added to enumerations, and members can have their own\nattributes -- see the documentation for details."}, {"type": "boolean"}]}, "type": "array"}], "title": "Value"}, "icon": {"type": "string", "title": "Icon"}}, "additionalProperties": true, "type": "object", "required": ["value"], "title": "KVItem", "description": "Kv-items have no uid and key/value rather than text.  Kv-items\ncan carry style hints.\n\nKey is optional, so it can also be used as a styled list."}, "MediaNode": {"properties": {"uid_": {"anyOf": [{"type": "string", "format": "uuid"}, {"type": "null"}], "title": "Uid "}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "tags": {"items": {"type": "string"}, "type": "array", "title": "Tags"}, "parent_id": {"anyOf": [{"type": "string", "format": "uuid"}, {"type": "null"}], "title": "Parent Id"}, "children_ids": {"items": {"type": "string", "format": "uuid"}, "type": "array", "uniqueItems": true, "title": "Children Ids"}, "url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "Url"}, "data": {"anyOf": [{"prefixItems": [{"type": "string", "format": "binary"}, {"type": "object"}], "type": "array", "maxItems": 2, "minItems": 2}, {"type": "string", "format": "binary"}, {"type": "string"}, {"type": "null"}], "title": "Data"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name"}, "spec": {"anyOf": [{"$ref": "#/components/schemas/MediaSpecification"}, {"type": "null"}]}, "media_role": {"anyOf": [{"$ref": "#/components/schemas/MediaRole"}, {"type": "null"}]}, "text": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Text"}, "realized_spec": {"anyOf": [{"$ref": "#/components/schemas/MediaSpecification"}, {"type": "null"}]}, "final_spec": {"anyOf": [{"$ref": "#/components/schemas/MediaSpecification"}, {"type": "null"}]}, "rit": {"allOf": [{"$ref": "#/components/schemas/ResourceInventoryTag"}]}}, "type": "object", "title": "MediaNode", "description": "MediaNode is an intermediate representation of a script-referenced media object.\n\nIt may be a state url or data, or it may be a named media resource, or it may be a\nprepared media resource.  Prepared media is created dynamically or semi-dynamically\n(for example, at world-initialization).\n\nFor named or prepared media objects, the file or data is actually managed by the\nbackend service layer.  The node carries a `ResourceInventoryTag` (RIT) that provides\nthe service layer with input to generate the final file location relative to a given\nserver.\n\nTechnically, the `media_role` is _not_ part of the associated resource, the role\n_links_ a resource to a narrative object, so the same resource can actually be used\nin many places and many roles."}, "MediaRole": {"type": "string", "enum": ["image", "narrative_im", "narrative_im_landscape", "narrative_im_portrait", "narrative_im_square", "avatar_im", "dialog_im", "info_im", "logo_im", "cover_im", "audio", "narrative_vox", "character_vox", "music", "sfx", "video", "animation", "extra"], "title": "MediaRole"}, "MediaSpecification": {"properties": {"uid_": {"anyOf": [{"type": "string", "format": "uuid"}, {"type": "null"}], "title": "Uid "}}, "type": "object", "title": "MediaSpecification"}, "Node": {"properties": {"uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "tags": {"items": {"type": "string"}, "type": "array", "title": "Tags"}, "parent_id": {"anyOf": [{"type": "string", "format": "uuid"}, {"type": "null"}], "title": "Parent Id"}, "children_ids": {"items": {"type": "string", "format": "uuid"}, "type": "array", "uniqueItems": true, "title": "Children Ids"}}, "type": "object", "title": "Node", "description": "The Node class represents a basic building block of a story or scene tree.\nNodes represent narrative beats, characters, locations, etc.\nEach node is inherently part of a graph, which is leveraged to provide a central index for all node relationships.\n\nEach Node has a unique identifier (uid), a public name (label), an optional parent Node and can have multiple child Nodes.\n\n:Attributes:\n  :ivar UUID uid: A unique identifier for this Node.\n  :ivar str label: A short identifier derived from a template name or its guid.\n  :ivar Node parent: The parent Node of this Node.\n  :ivar Node root: The root Node of this Node's tree.\n  :ivar str path: The path from the root Node to this Node (used as a unique label).\n  :ivar Graph Graph: The Graph object collection that contains this Node.  Omitted from serialization to prevent recursion issues.\n  :ivar list tags: String or Enum tags associated with the Node.\n  :ivar dict children: A list of child Nodes.\n  :ivar: UUID parent_id children_ids: Enable tree-like structuring within the graph by tracking relationships through identifiers rather than direct references, simplifying serialization.\n\n:Methods:\n  - `add_child`, `remove_child`: Manage hierarchical relationships, facilitating dynamic narrative branching.\n  - `find_children`, `find_child`: Offer search capabilities within a node's descendants, supporting complex narrative logic.\n  - `ancestors`, `path`: Provide navigation and lookup capabilities within the graph's structure, essential for tracing narrative paths and relationships.\n\n:Mixin Classes:\n\nLike its base-class, Entity, Node is designed to be extended with various mixin-classes. These mixins add graph-related functionality to the Node, trading, and traversal.\n\n- :class:`~tangl.graph.mixins.Associating`: Adds transient connections the Node.\n- :class:`~tangl.graph.mixins.Trader`: Adds Node-trading functionality to the Node.\n- :class:`~tangl.graph.mixins.Traversable`: Adds graph traversal functionality to the Node.\n- :class:`~tangl.graph.mixins.Plugins`: Adds plugin hooks to various Entity and Node features.\n\nNodes can be factoried from various representations with a GraphFactory.  Like Entity, they\ncan self-cast by using the reserved kwarg 'obj_cls' to reference any subclass of Node.\n\nRelies on Pydantic initialization for serialization and deserialization.\n\n:Example:\n\n>>> root = Node(label=\"root\")\n>>> child1 = Node(label=\"child1\")\n>>> root.add_child(child1)"}, "ResourceDataType": {"type": "string", "enum": ["image", "vector", "audio"], "title": "ResourceDataType"}, "ResourceInventoryTag": {"properties": {"uid_": {"type": "string", "format": "uuid", "title": "Uid "}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "tags": {"items": {"type": "string"}, "type": "array", "title": "Tags"}, "name": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Name"}, "data_hash": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Data Hash"}, "resource_type": {"$ref": "#/components/schemas/ResourceDataType"}, "inventory_time": {"type": "string", "format": "date-time", "title": "Inventory Time"}, "expiry": {"anyOf": [{"type": "string", "format": "date-time"}, {"type": "string", "format": "duration"}, {"type": "null"}], "title": "Expiry"}}, "type": "object", "required": ["resource_type"], "title": "ResourceInventoryTag"}, "StyledJournalItem": {"properties": {"style_id": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Style Id"}, "style_cls": {"anyOf": [{"type": "string"}, {"items": {"type": "string"}, "type": "array"}], "title": "Style Cls"}, "style_dict": {"anyOf": [{"additionalProperties": {"type": "string"}, "type": "object"}, {"type": "null"}], "title": "Style Dict"}, "uid": {"type": "string", "format": "uuid", "title": "Uid"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Label"}, "text": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Text"}, "icon": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Icon"}}, "additionalProperties": true, "type": "object", "required": ["uid"], "title": "StyledJournalItem", "description": "Extends BaseJournalItem with style information.\n\nAttributes:\n  - uid (uuid.UUID): Unique identifier of the generating story entity.\n  - text (str): Main content text.\n  - icon (str): Suggested icon.\n  - style_dict (dict[str, str]): Suggested HTML style attributes\n  - style_cls (list[str]): Suggested HTML .classes for styling\n  - style_id (str): Suggested HTML #id"}, "SystemInfo": {"properties": {"engine": {"type": "string", "title": "Engine"}, "version": {"type": "string", "title": "Version"}, "uptime": {"type": "string", "title": "Uptime"}, "worlds": {"type": "integer", "title": "Worlds"}, "users": {"type": "integer", "title": "Users"}, "homepage_url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "Homepage Url"}, "media": {"anyOf": [{"items": {"anyOf": [{"$ref": "#/components/schemas/MediaNode"}, {"$ref": "#/components/schemas/JournalMediaItem"}]}, "type": "array"}, {"type": "null"}], "title": "Media"}, "app_url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "App Url"}, "api_url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "Api Url"}, "guide_url": {"anyOf": [{"type": "string", "minLength": 1, "format": "uri"}, {"type": "null"}], "title": "Guide Url"}}, "additionalProperties": true, "type": "object", "required": ["engine", "version", "uptime", "worlds", "users"], "title": "SystemInfo"}, "UIConfig": {"properties": {"brand_color": {"type": "string", "title": "Brand Color"}, "brand_font": {"type": "string", "title": "Brand Font"}}, "type": "object", "required": ["brand_color"], "title": "UIConfig"}, "UserInfo": {"properties": {"user_id": {"type": "string", "format": "uuid", "title": "User Id"}, "user_secret": {"type": "string", "title": "User Secret"}, "created_dt": {"type": "string", "format": "date-time", "title": "Created Dt"}, "last_played_dt": {"anyOf": [{"type": "string", "format": "date-time"}, {"type": "null"}], "title": "Last Played Dt"}, "worlds_played": {"items": {"type": "string", "format": "uuid"}, "type": "array", "uniqueItems": true, "title": "Worlds Played"}, "stories_finished": {"type": "integer", "title": "Stories Finished", "default": 0}, "turns_played": {"type": "integer", "title": "Turns Played", "default": 0}, "achievements": {"anyOf": [{"items": {"type": "string"}, "type": "array", "uniqueItems": true}, {"type": "null"}], "title": "Achievements"}}, "additionalProperties": true, "type": "object", "required": ["user_id", "user_secret", "created_dt", "worlds_played", "achievements"], "title": "UserInfo"}, "UserSecret": {"prefixItems": [{"title": "User Id"}, {"title": "User Secret"}], "type": "array", "maxItems": 2, "minItems": 2}, "UserSecret_": {"properties": {"user_secret": {"type": "string", "title": "User Secret"}, "user_id": {"type": "string", "format": "uuid", "title": "User Id"}}, "type": "object", "required": ["user_secret", "user_id"], "title": "UserSecret_"}, "ValidationError": {"properties": {"loc": {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}]}, "type": "array", "title": "Location"}, "msg": {"type": "string", "title": "Message"}, "type": {"type": "string", "title": "Error Type"}}, "type": "object", "required": ["loc", "msg", "type"], "title": "ValidationError"}, "WorldInfo": {"properties": {"label": {"type": "string", "title": "Label"}, "version": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Version"}, "title": {"type": "string", "title": "Title"}, "author": {"anyOf": [{"type": "string"}, {"items": {"type": "string"}, "type": "array"}], "title": "Author"}, "comments": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Comments", "markdown": true}, "ui_config": {"anyOf": [{"$ref": "#/components/schemas/UIConfig"}, {"type": "null"}]}, "media": {"anyOf": [{"items": {"anyOf": [{"$ref": "#/components/schemas/MediaNode"}, {"$ref": "#/components/schemas/JournalMediaItem"}]}, "type": "array"}, {"type": "null"}], "title": "Media"}}, "type": "object", "required": ["label", "title", "author"], "title": "WorldInfo"}, "WorldListItem": {"properties": {"style_id": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Style Id"}, "style_cls": {"anyOf": [{"type": "string"}, {"items": {"type": "string"}, "type": "array"}], "title": "Style Cls"}, "style_dict": {"anyOf": [{"additionalProperties": {"type": "string"}, "type": "object"}, {"type": "null"}], "title": "Style Dict"}, "key": {"anyOf": [{"type": "string"}, {"type": "null"}], "title": "Key"}, "value": {"anyOf": [{"type": "string"}, {"type": "integer"}, {"type": "number"}, {"enum": [], "title": "Enum", "description": "Create a collection of name/value pairs.\n\nExample enumeration:\n\n>>> class Color(Enum):\n...     RED = 1\n...     BLUE = 2\n...     GREEN = 3\n\nAccess them by:\n\n- attribute access::\n\n>>> Color.RED\n<Color.RED: 1>\n\n- value lookup:\n\n>>> Color(1)\n<Color.RED: 1>\n\n- name lookup:\n\n>>> Color['RED']\n<Color.RED: 1>\n\nEnumerations can be iterated over, and know how many members they have:\n\n>>> len(Color)\n3\n\n>>> list(Color)\n[<Color.RED: 1>, <Color.BLUE: 2>, <Color.GREEN: 3>]\n\nMethods can be added to enumerations, and members can have their own\nattributes -- see the documentation for details."}, {"type": "boolean"}, {"items": {"anyOf": [{"type": "string"}, {"type": "integer"}, {"type": "number"}, {"enum": [], "title": "Enum", "description": "Create a collection of name/value pairs.\n\nExample enumeration:\n\n>>> class Color(Enum):\n...     RED = 1\n...     BLUE = 2\n...     GREEN = 3\n\nAccess them by:\n\n- attribute access::\n\n>>> Color.RED\n<Color.RED: 1>\n\n- value lookup:\n\n>>> Color(1)\n<Color.RED: 1>\n\n- name lookup:\n\n>>> Color['RED']\n<Color.RED: 1>\n\nEnumerations can be iterated over, and know how many members they have:\n\n>>> len(Color)\n3\n\n>>> list(Color)\n[<Color.RED: 1>, <Color.BLUE: 2>, <Color.GREEN: 3>]\n\nMethods can be added to enumerations, and members can have their own\nattributes -- see the documentation for details."}, {"type": "boolean"}]}, "type": "array"}], "title": "Value"}, "icon": {"type": "string", "title": "Icon"}}, "additionalProperties": true, "type": "object", "required": ["value"], "title": "WorldListItem", "example": {"key": "StoryTangl", "style_hints": {"color": "orange"}, "value": "ac1"}}}}}