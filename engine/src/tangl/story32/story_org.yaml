# Story Subpackage
# ----------------
deps: [core, utils]
classes:

  - ScriptItem:
      has:
        - template  # schema data, kwargs for graph instantiation
      friends: [ScriptManager]

  - StoryWorld(Singleton, HasContext):
      has:
        - Registry[ScriptItem] => ScriptManager
        - Registry[AssetType] => AssetManager
        - create_story() -> StoryGraph
      friends: [WorldController]

  - StoryGraph(TraversableGraph[StoryNode], HasContext):
      has:
        - player   # Dedicated story node for player/reader scoped variables
      friends: [StoryController]

  - StoryNode(Node, HasContext):
      has:
        - story => Node.graph -> TraversableGraph

      subclasses:

        # Concept Nodes
        - Actor:
            has: describe()
            friends: [DynamicEdge[Actor]=>Role, Look]
        - Place:
            has: describe()
            friends: [DynamicEdge[Place]=>Setting]
        - Asset:
            has: describe()
            variants:
              - WrappedSingleton[AssetType] => DiscreteAsset:
              - CountableAsset:
                  friends: [Counter[AssetType] => Wallet]
        - NarrativeLandmark:

        # Structure/Plot Nodes
        - Scene(Traversable):    # a DAG-like collection of blocks
          has:
            - blocks
        - Block(Traversable, HasContent):
          has:
            - actions/motivators
          subclasses:
            - Menu:
        - Action(TraversableEdge):
          has:
            - activation_trigger  # on conditions satisfied, or block for input
